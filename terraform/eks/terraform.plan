{
    "format_version": "1.2",
    "terraform_version": "1.5.7",
    "variables": {
        "cluster_name": {
            "value": "cis-eks-compliant"
        },
        "cluster_version": {
            "value": "1.28"
        },
        "desired_capacity": {
            "value": 2
        },
        "max_size": {
            "value": 3
        },
        "min_size": {
            "value": 1
        },
        "node_instance_type": {
            "value": "t3.small"
        },
        "private_subnets": {
            "value": [
                "10.0.1.0/24",
                "10.0.2.0/24",
                "10.0.3.0/24"
            ]
        },
        "public_subnets": {
            "value": [
                "10.0.4.0/24",
                "10.0.5.0/24",
                "10.0.6.0/24"
            ]
        },
        "region": {
            "value": "us-west-2"
        },
        "vpc_cidr": {
            "value": "10.0.0.0/16"
        }
    },
    "planned_values": {
        "outputs": {
            "cluster_name": {
                "sensitive": false,
                "type": "string",
                "value": "cis-eks-compliant"
            },
            "region": {
                "sensitive": false,
                "type": "string",
                "value": "us-west-2"
            }
        },
        "root_module": {
            "resources": [
                {
                    "address": "aws_eks_cluster.main",
                    "mode": "managed",
                    "type": "aws_eks_cluster",
                    "name": "main",
                    "provider_name": "registry.terraform.io/hashicorp/aws",
                    "schema_version": 1,
                    "values": {
                        "bootstrap_self_managed_addons": true,
                        "compute_config": [],
                        "enabled_cluster_log_types": [
                            "api",
                            "audit",
                            "authenticator",
                            "controllerManager",
                            "scheduler"
                        ],
                        "encryption_config": [
                            {
                                "provider": [
                                    {}
                                ],
                                "resources": [
                                    "secrets"
                                ]
                            }
                        ],
                        "force_update_version": null,
                        "kubernetes_network_config": [
                            {
                                "service_ipv4_cidr": "10.100.0.0/16"
                            }
                        ],
                        "name": "cis-eks-compliant",
                        "outpost_config": [],
                        "remote_network_config": [],
                        "storage_config": [],
                        "tags": null,
                        "timeouts": null,
                        "version": "1.28",
                        "vpc_config": [
                            {
                                "endpoint_private_access": true,
                                "endpoint_public_access": false,
                                "security_group_ids": null
                            }
                        ],
                        "zonal_shift_config": []
                    },
                    "sensitive_values": {
                        "access_config": [],
                        "certificate_authority": [],
                        "compute_config": [],
                        "enabled_cluster_log_types": [
                            false,
                            false,
                            false,
                            false,
                            false
                        ],
                        "encryption_config": [
                            {
                                "provider": [
                                    {}
                                ],
                                "resources": [
                                    false
                                ]
                            }
                        ],
                        "identity": [],
                        "kubernetes_network_config": [
                            {
                                "elastic_load_balancing": []
                            }
                        ],
                        "outpost_config": [],
                        "remote_network_config": [],
                        "storage_config": [],
                        "tags_all": {},
                        "upgrade_policy": [],
                        "vpc_config": [
                            {
                                "public_access_cidrs": [],
                                "subnet_ids": []
                            }
                        ],
                        "zonal_shift_config": []
                    }
                },
                {
                    "address": "aws_eks_node_group.main",
                    "mode": "managed",
                    "type": "aws_eks_node_group",
                    "name": "main",
                    "provider_name": "registry.terraform.io/hashicorp/aws",
                    "schema_version": 0,
                    "values": {
                        "capacity_type": "ON_DEMAND",
                        "cluster_name": "cis-eks-compliant",
                        "force_update_version": null,
                        "instance_types": [
                            "t3.small"
                        ],
                        "labels": null,
                        "launch_template": [],
                        "node_group_name": "compliant-ng",
                        "remote_access": [],
                        "scaling_config": [
                            {
                                "desired_size": 1,
                                "max_size": 1,
                                "min_size": 1
                            }
                        ],
                        "tags": null,
                        "taint": [],
                        "timeouts": null,
                        "ami_type": "AL2_x86_64"
                    },
                    "sensitive_values": {
                        "instance_types": [
                            false
                        ],
                        "launch_template": [],
                        "node_repair_config": [],
                        "remote_access": [],
                        "resources": [],
                        "scaling_config": [
                            {}
                        ],
                        "subnet_ids": [],
                        "tags_all": {},
                        "taint": [],
                        "update_config": []
                    }
                },
                {
                    "address": "aws_iam_role.eks",
                    "mode": "managed",
                    "type": "aws_iam_role",
                    "name": "eks",
                    "provider_name": "registry.terraform.io/hashicorp/aws",
                    "schema_version": 0,
                    "values": {
                        "assume_role_policy": "{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"eks.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}",
                        "description": null,
                        "force_detach_policies": false,
                        "max_session_duration": 3600,
                        "name": "cis-eks-compliant-eks-role",
                        "path": "/",
                        "permissions_boundary": null,
                        "tags": null
                    },
                    "sensitive_values": {
                        "inline_policy": [],
                        "managed_policy_arns": [],
                        "tags_all": {}
                    }
                },
                {
                    "address": "aws_iam_role.eks_node_group",
                    "mode": "managed",
                    "type": "aws_iam_role",
                    "name": "eks_node_group",
                    "provider_name": "registry.terraform.io/hashicorp/aws",
                    "schema_version": 0,
                    "values": {
                        "assume_role_policy": "{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"ec2.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}",
                        "description": null,
                        "force_detach_policies": false,
                        "max_session_duration": 3600,
                        "name": "cis-eks-compliant-node-group-role",
                        "path": "/",
                        "permissions_boundary": null,
                        "tags": null
                    },
                    "sensitive_values": {
                        "inline_policy": [],
                        "managed_policy_arns": [],
                        "tags_all": {}
                    }
                },
                {
                    "address": "aws_iam_role_policy_attachment.ec2_container_registry",
                    "mode": "managed",
                    "type": "aws_iam_role_policy_attachment",
                    "name": "ec2_container_registry",
                    "provider_name": "registry.terraform.io/hashicorp/aws",
                    "schema_version": 0,
                    "values": {
                        "policy_arn": "arn:aws:iam::aws:policy/AmazonEC2ContainerRegistryReadOnly",
                        "role": "cis-eks-compliant-node-group-role"
                    },
                    "sensitive_values": {}
                },
                {
                    "address": "aws_iam_role_policy_attachment.eks_cluster_policy",
                    "mode": "managed",
                    "type": "aws_iam_role_policy_attachment",
                    "name": "eks_cluster_policy",
                    "provider_name": "registry.terraform.io/hashicorp/aws",
                    "schema_version": 0,
                    "values": {
                        "policy_arn": "arn:aws:iam::aws:policy/AmazonEKSClusterPolicy",
                        "role": "cis-eks-compliant-eks-role"
                    },
                    "sensitive_values": {}
                },
                {
                    "address": "aws_iam_role_policy_attachment.eks_cni",
                    "mode": "managed",
                    "type": "aws_iam_role_policy_attachment",
                    "name": "eks_cni",
                    "provider_name": "registry.terraform.io/hashicorp/aws",
                    "schema_version": 0,
                    "values": {
                        "policy_arn": "arn:aws:iam::aws:policy/AmazonEKS_CNI_Policy",
                        "role": "cis-eks-compliant-node-group-role"
                    },
                    "sensitive_values": {}
                },
                {
                    "address": "aws_iam_role_policy_attachment.eks_worker_node",
                    "mode": "managed",
                    "type": "aws_iam_role_policy_attachment",
                    "name": "eks_worker_node",
                    "provider_name": "registry.terraform.io/hashicorp/aws",
                    "schema_version": 0,
                    "values": {
                        "policy_arn": "arn:aws:iam::aws:policy/AmazonEKSWorkerNodePolicy",
                        "role": "cis-eks-compliant-node-group-role"
                    },
                    "sensitive_values": {}
                },
                {
                    "address": "aws_kms_key.eks",
                    "mode": "managed",
                    "type": "aws_kms_key",
                    "name": "eks",
                    "provider_name": "registry.terraform.io/hashicorp/aws",
                    "schema_version": 0,
                    "values": {
                        "bypass_policy_lockout_safety_check": false,
                        "custom_key_store_id": null,
                        "customer_master_key_spec": "SYMMETRIC_DEFAULT",
                        "deletion_window_in_days": 7,
                        "description": "EKS Secret Encryption Key",
                        "enable_key_rotation": true,
                        "is_enabled": true,
                        "key_usage": "ENCRYPT_DECRYPT",
                        "tags": null,
                        "timeouts": null,
                        "xks_key_id": null
                    },
                    "sensitive_values": {
                        "tags_all": {}
                    }
                },
                {
                    "address": "aws_security_group.nodes",
                    "mode": "managed",
                    "type": "aws_security_group",
                    "name": "nodes",
                    "provider_name": "registry.terraform.io/hashicorp/aws",
                    "schema_version": 1,
                    "values": {
                        "description": "Node group security group",
                        "egress": [
                            {
                                "cidr_blocks": [
                                    "0.0.0.0/0"
                                ],
                                "description": "",
                                "from_port": 0,
                                "ipv6_cidr_blocks": [],
                                "prefix_list_ids": [],
                                "protocol": "-1",
                                "security_groups": [],
                                "self": false,
                                "to_port": 0
                            }
                        ],
                        "ingress": [
                            {
                                "cidr_blocks": [],
                                "description": "",
                                "from_port": 0,
                                "ipv6_cidr_blocks": [],
                                "prefix_list_ids": [],
                                "protocol": "-1",
                                "security_groups": [],
                                "self": true,
                                "to_port": 0
                            }
                        ],
                        "name": "cis-eks-compliant-nodes",
                        "revoke_rules_on_delete": false,
                        "tags": null,
                        "timeouts": null
                    },
                    "sensitive_values": {
                        "egress": [
                            {
                                "cidr_blocks": [
                                    false
                                ],
                                "ipv6_cidr_blocks": [],
                                "prefix_list_ids": [],
                                "security_groups": []
                            }
                        ],
                        "ingress": [
                            {
                                "cidr_blocks": [],
                                "ipv6_cidr_blocks": [],
                                "prefix_list_ids": [],
                                "security_groups": []
                            }
                        ],
                        "tags_all": {}
                    }
                },
                {
                    "address": "aws_subnet.private[0]",
                    "mode": "managed",
                    "type": "aws_subnet",
                    "name": "private",
                    "index": 0,
                    "provider_name": "registry.terraform.io/hashicorp/aws",
                    "schema_version": 1,
                    "values": {
                        "assign_ipv6_address_on_creation": false,
                        "availability_zone": "us-west-2a",
                        "cidr_block": "10.0.1.0/24",
                        "customer_owned_ipv4_pool": null,
                        "enable_dns64": false,
                        "enable_lni_at_device_index": null,
                        "enable_resource_name_dns_a_record_on_launch": false,
                        "enable_resource_name_dns_aaaa_record_on_launch": false,
                        "ipv6_cidr_block": null,
                        "ipv6_native": false,
                        "map_customer_owned_ip_on_launch": null,
                        "map_public_ip_on_launch": false,
                        "outpost_arn": null,
                        "tags": {
                            "kubernetes.io/cluster/cis-eks-compliant": "owned",
                            "kubernetes.io/role/internal-elb": "1"
                        },
                        "tags_all": {
                            "kubernetes.io/cluster/cis-eks-compliant": "owned",
                            "kubernetes.io/role/internal-elb": "1"
                        },
                        "timeouts": null
                    },
                    "sensitive_values": {
                        "tags": {},
                        "tags_all": {}
                    }
                },
                {
                    "address": "aws_subnet.private[1]",
                    "mode": "managed",
                    "type": "aws_subnet",
                    "name": "private",
                    "index": 1,
                    "provider_name": "registry.terraform.io/hashicorp/aws",
                    "schema_version": 1,
                    "values": {
                        "assign_ipv6_address_on_creation": false,
                        "availability_zone": "us-west-2b",
                        "cidr_block": "10.0.2.0/24",
                        "customer_owned_ipv4_pool": null,
                        "enable_dns64": false,
                        "enable_lni_at_device_index": null,
                        "enable_resource_name_dns_a_record_on_launch": false,
                        "enable_resource_name_dns_aaaa_record_on_launch": false,
                        "ipv6_cidr_block": null,
                        "ipv6_native": false,
                        "map_customer_owned_ip_on_launch": null,
                        "map_public_ip_on_launch": false,
                        "outpost_arn": null,
                        "tags": {
                            "kubernetes.io/cluster/cis-eks-compliant": "owned",
                            "kubernetes.io/role/internal-elb": "1"
                        },
                        "tags_all": {
                            "kubernetes.io/cluster/cis-eks-compliant": "owned",
                            "kubernetes.io/role/internal-elb": "1"
                        },
                        "timeouts": null
                    },
                    "sensitive_values": {
                        "tags": {},
                        "tags_all": {}
                    }
                },
                {
                    "address": "aws_subnet.private[2]",
                    "mode": "managed",
                    "type": "aws_subnet",
                    "name": "private",
                    "index": 2,
                    "provider_name": "registry.terraform.io/hashicorp/aws",
                    "schema_version": 1,
                    "values": {
                        "assign_ipv6_address_on_creation": false,
                        "availability_zone": "us-west-2c",
                        "cidr_block": "10.0.3.0/24",
                        "customer_owned_ipv4_pool": null,
                        "enable_dns64": false,
                        "enable_lni_at_device_index": null,
                        "enable_resource_name_dns_a_record_on_launch": false,
                        "enable_resource_name_dns_aaaa_record_on_launch": false,
                        "ipv6_cidr_block": null,
                        "ipv6_native": false,
                        "map_customer_owned_ip_on_launch": null,
                        "map_public_ip_on_launch": false,
                        "outpost_arn": null,
                        "tags": {
                            "kubernetes.io/cluster/cis-eks-compliant": "owned",
                            "kubernetes.io/role/internal-elb": "1"
                        },
                        "tags_all": {
                            "kubernetes.io/cluster/cis-eks-compliant": "owned",
                            "kubernetes.io/role/internal-elb": "1"
                        },
                        "timeouts": null
                    },
                    "sensitive_values": {
                        "tags": {},
                        "tags_all": {}
                    }
                },
                {
                    "address": "aws_vpc.main",
                    "mode": "managed",
                    "type": "aws_vpc",
                    "name": "main",
                    "provider_name": "registry.terraform.io/hashicorp/aws",
                    "schema_version": 1,
                    "values": {
                        "assign_generated_ipv6_cidr_block": null,
                        "cidr_block": "10.0.0.0/16",
                        "enable_dns_hostnames": true,
                        "enable_dns_support": true,
                        "instance_tenancy": "default",
                        "ipv4_ipam_pool_id": null,
                        "ipv4_netmask_length": null,
                        "ipv6_ipam_pool_id": null,
                        "ipv6_netmask_length": null,
                        "tags": null
                    },
                    "sensitive_values": {
                        "tags_all": {}
                    }
                },
                {
                    "address": "data.aws_eks_cluster.main",
                    "mode": "data",
                    "type": "aws_eks_cluster",
                    "name": "main",
                    "provider_name": "registry.terraform.io/hashicorp/aws",
                    "schema_version": 0,
                    "values": {
                        "name": "cis-eks-compliant"
                    },
                    "sensitive_values": {
                        "access_config": [],
                        "certificate_authority": [],
                        "compute_config": [],
                        "enabled_cluster_log_types": [],
                        "identity": [],
                        "kubernetes_network_config": [],
                        "outpost_config": [],
                        "remote_network_config": [],
                        "storage_config": [],
                        "tags": {},
                        "upgrade_policy": [],
                        "vpc_config": [],
                        "zonal_shift_config": []
                    }
                },
                {
                    "address": "data.aws_eks_cluster_auth.main",
                    "mode": "data",
                    "type": "aws_eks_cluster_auth",
                    "name": "main",
                    "provider_name": "registry.terraform.io/hashicorp/aws",
                    "schema_version": 0,
                    "values": {
                        "name": "cis-eks-compliant"
                    },
                    "sensitive_values": {}
                },
                {
                    "address": "kubernetes_network_policy.default_deny_all",
                    "mode": "managed",
                    "type": "kubernetes_network_policy",
                    "name": "default_deny_all",
                    "provider_name": "registry.terraform.io/hashicorp/kubernetes",
                    "schema_version": 0,
                    "values": {
                        "metadata": [
                            {
                                "annotations": null,
                                "generate_name": null,
                                "labels": null,
                                "name": "default-deny-all",
                                "namespace": "default"
                            }
                        ],
                        "spec": [
                            {
                                "egress": [],
                                "ingress": [],
                                "pod_selector": [
                                    {
                                        "match_expressions": [],
                                        "match_labels": null
                                    }
                                ],
                                "policy_types": [
                                    "Ingress",
                                    "Egress"
                                ]
                            }
                        ]
                    },
                    "sensitive_values": {
                        "metadata": [
                            {}
                        ],
                        "spec": [
                            {
                                "egress": [],
                                "ingress": [],
                                "pod_selector": [
                                    {
                                        "match_expressions": []
                                    }
                                ],
                                "policy_types": [
                                    false,
                                    false
                                ]
                            }
                        ]
                    }
                }
            ]
        }
    },
    "resource_changes": [
        {
            "address": "data.aws_eks_cluster.main",
            "mode": "data",
            "type": "aws_eks_cluster",
            "name": "main",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
                "actions": [
                    "read"
                ],
                "before": null,
                "after": {
                    "name": "cis-eks-compliant"
                },
                "after_unknown": {
                    "access_config": true,
                    "arn": true,
                    "certificate_authority": true,
                    "cluster_id": true,
                    "compute_config": true,
                    "created_at": true,
                    "enabled_cluster_log_types": true,
                    "endpoint": true,
                    "id": true,
                    "identity": true,
                    "kubernetes_network_config": true,
                    "outpost_config": true,
                    "platform_version": true,
                    "remote_network_config": true,
                    "role_arn": true,
                    "status": true,
                    "storage_config": true,
                    "tags": true,
                    "upgrade_policy": true,
                    "version": true,
                    "vpc_config": true,
                    "zonal_shift_config": true
                },
                "before_sensitive": false,
                "after_sensitive": {
                    "access_config": [],
                    "certificate_authority": [],
                    "compute_config": [],
                    "enabled_cluster_log_types": [],
                    "identity": [],
                    "kubernetes_network_config": [],
                    "outpost_config": [],
                    "remote_network_config": [],
                    "storage_config": [],
                    "tags": {},
                    "upgrade_policy": [],
                    "vpc_config": [],
                    "zonal_shift_config": []
                }
            },
            "action_reason": "read_because_dependency_pending"
        },
        {
            "address": "data.aws_eks_cluster_auth.main",
            "mode": "data",
            "type": "aws_eks_cluster_auth",
            "name": "main",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
                "actions": [
                    "read"
                ],
                "before": null,
                "after": {
                    "name": "cis-eks-compliant"
                },
                "after_unknown": {
                    "id": true,
                    "token": true
                },
                "before_sensitive": false,
                "after_sensitive": {
                    "token": true
                }
            },
            "action_reason": "read_because_dependency_pending"
        },
        {
            "address": "aws_eks_cluster.main",
            "mode": "managed",
            "type": "aws_eks_cluster",
            "name": "main",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
                "actions": [
                    "create"
                ],
                "before": null,
                "after": {
                    "bootstrap_self_managed_addons": true,
                    "compute_config": [],
                    "enabled_cluster_log_types": [
                        "api",
                        "audit",
                        "authenticator",
                        "controllerManager",
                        "scheduler"
                    ],
                    "encryption_config": [
                        {
                            "provider": [
                                {}
                            ],
                            "resources": [
                                "secrets"
                            ]
                        }
                    ],
                    "force_update_version": null,
                    "kubernetes_network_config": [
                        {
                            "service_ipv4_cidr": "10.100.0.0/16"
                        }
                    ],
                    "name": "cis-eks-compliant",
                    "outpost_config": [],
                    "remote_network_config": [],
                    "storage_config": [],
                    "tags": null,
                    "timeouts": null,
                    "version": "1.28",
                    "vpc_config": [
                        {
                            "endpoint_private_access": true,
                            "endpoint_public_access": false,
                            "security_group_ids": null
                        }
                    ],
                    "zonal_shift_config": []
                },
                "after_unknown": {
                    "access_config": true,
                    "arn": true,
                    "certificate_authority": true,
                    "cluster_id": true,
                    "compute_config": [],
                    "created_at": true,
                    "enabled_cluster_log_types": [
                        false,
                        false,
                        false,
                        false,
                        false
                    ],
                    "encryption_config": [
                        {
                            "provider": [
                                {
                                    "key_arn": true
                                }
                            ],
                            "resources": [
                                false
                            ]
                        }
                    ],
                    "endpoint": true,
                    "id": true,
                    "identity": true,
                    "kubernetes_network_config": [
                        {
                            "elastic_load_balancing": true,
                            "ip_family": true,
                            "service_ipv6_cidr": true
                        }
                    ],
                    "outpost_config": [],
                    "platform_version": true,
                    "remote_network_config": [],
                    "role_arn": true,
                    "status": true,
                    "storage_config": [],
                    "tags_all": true,
                    "upgrade_policy": true,
                    "vpc_config": [
                        {
                            "cluster_security_group_id": true,
                            "public_access_cidrs": true,
                            "subnet_ids": true,
                            "vpc_id": true
                        }
                    ],
                    "zonal_shift_config": []
                },
                "before_sensitive": false,
                "after_sensitive": {
                    "access_config": [],
                    "certificate_authority": [],
                    "compute_config": [],
                    "enabled_cluster_log_types": [
                        false,
                        false,
                        false,
                        false,
                        false
                    ],
                    "encryption_config": [
                        {
                            "provider": [
                                {}
                            ],
                            "resources": [
                                false
                            ]
                        }
                    ],
                    "identity": [],
                    "kubernetes_network_config": [
                        {
                            "elastic_load_balancing": []
                        }
                    ],
                    "outpost_config": [],
                    "remote_network_config": [],
                    "storage_config": [],
                    "tags_all": {},
                    "upgrade_policy": [],
                    "vpc_config": [
                        {
                            "public_access_cidrs": [],
                            "subnet_ids": []
                        }
                    ],
                    "zonal_shift_config": []
                }
            }
        },
        {
            "address": "aws_eks_node_group.main",
            "mode": "managed",
            "type": "aws_eks_node_group",
            "name": "main",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
                "actions": [
                    "create"
                ],
                "before": null,
                "after": {
                    "capacity_type": "ON_DEMAND",
                    "cluster_name": "cis-eks-compliant",
                    "force_update_version": null,
                    "instance_types": [
                        "t3.small"
                    ],
                    "labels": null,
                    "launch_template": [],
                    "node_group_name": "compliant-ng",
                    "remote_access": [],
                    "scaling_config": [
                        {
                            "desired_size": 1,
                            "max_size": 1,
                            "min_size": 1
                        }
                    ],
                    "tags": null,
                    "taint": [],
                    "timeouts": null,
                    "ami_type": "AL2_x86_64"
                },
                "after_unknown": {
                    "ami_type": true,
                    "arn": true,
                    "disk_size": true,
                    "id": true,
                    "instance_types": [
                        false
                    ],
                    "launch_template": [],
                    "node_group_name_prefix": true,
                    "node_repair_config": true,
                    "node_role_arn": true,
                    "release_version": true,
                    "remote_access": [],
                    "resources": true,
                    "scaling_config": [
                        {}
                    ],
                    "status": true,
                    "subnet_ids": true,
                    "tags_all": true,
                    "taint": [],
                    "update_config": true,
                    "version": true
                },
                "before_sensitive": false,
                "after_sensitive": {
                    "instance_types": [
                        false
                    ],
                    "launch_template": [],
                    "node_repair_config": [],
                    "remote_access": [],
                    "resources": [],
                    "scaling_config": [
                        {}
                    ],
                    "subnet_ids": [],
                    "tags_all": {},
                    "taint": [],
                    "update_config": []
                }
            }
        },
        {
            "address": "aws_iam_role.eks",
            "mode": "managed",
            "type": "aws_iam_role",
            "name": "eks",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
                "actions": [
                    "create"
                ],
                "before": null,
                "after": {
                    "assume_role_policy": "{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"eks.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}",
                    "description": null,
                    "force_detach_policies": false,
                    "max_session_duration": 3600,
                    "name": "cis-eks-compliant-eks-role",
                    "path": "/",
                    "permissions_boundary": null,
                    "tags": null
                },
                "after_unknown": {
                    "arn": true,
                    "create_date": true,
                    "id": true,
                    "inline_policy": true,
                    "managed_policy_arns": true,
                    "name_prefix": true,
                    "tags_all": true,
                    "unique_id": true
                },
                "before_sensitive": false,
                "after_sensitive": {
                    "inline_policy": [],
                    "managed_policy_arns": [],
                    "tags_all": {}
                }
            }
        },
        {
            "address": "aws_iam_role.eks_node_group",
            "mode": "managed",
            "type": "aws_iam_role",
            "name": "eks_node_group",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
                "actions": [
                    "create"
                ],
                "before": null,
                "after": {
                    "assume_role_policy": "{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"ec2.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}",
                    "description": null,
                    "force_detach_policies": false,
                    "max_session_duration": 3600,
                    "name": "cis-eks-compliant-node-group-role",
                    "path": "/",
                    "permissions_boundary": null,
                    "tags": null
                },
                "after_unknown": {
                    "arn": true,
                    "create_date": true,
                    "id": true,
                    "inline_policy": true,
                    "managed_policy_arns": true,
                    "name_prefix": true,
                    "tags_all": true,
                    "unique_id": true
                },
                "before_sensitive": false,
                "after_sensitive": {
                    "inline_policy": [],
                    "managed_policy_arns": [],
                    "tags_all": {}
                }
            }
        },
        {
            "address": "aws_iam_role_policy_attachment.ec2_container_registry",
            "mode": "managed",
            "type": "aws_iam_role_policy_attachment",
            "name": "ec2_container_registry",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
                "actions": [
                    "create"
                ],
                "before": null,
                "after": {
                    "policy_arn": "arn:aws:iam::aws:policy/AmazonEC2ContainerRegistryReadOnly",
                    "role": "cis-eks-compliant-node-group-role"
                },
                "after_unknown": {
                    "id": true
                },
                "before_sensitive": false,
                "after_sensitive": {}
            }
        },
        {
            "address": "aws_iam_role_policy_attachment.eks_cluster_policy",
            "mode": "managed",
            "type": "aws_iam_role_policy_attachment",
            "name": "eks_cluster_policy",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
                "actions": [
                    "create"
                ],
                "before": null,
                "after": {
                    "policy_arn": "arn:aws:iam::aws:policy/AmazonEKSClusterPolicy",
                    "role": "cis-eks-compliant-eks-role"
                },
                "after_unknown": {
                    "id": true
                },
                "before_sensitive": false,
                "after_sensitive": {}
            }
        },
        {
            "address": "aws_iam_role_policy_attachment.eks_cni",
            "mode": "managed",
            "type": "aws_iam_role_policy_attachment",
            "name": "eks_cni",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
                "actions": [
                    "create"
                ],
                "before": null,
                "after": {
                    "policy_arn": "arn:aws:iam::aws:policy/AmazonEKS_CNI_Policy",
                    "role": "cis-eks-compliant-node-group-role"
                },
                "after_unknown": {
                    "id": true
                },
                "before_sensitive": false,
                "after_sensitive": {}
            }
        },
        {
            "address": "aws_iam_role_policy_attachment.eks_worker_node",
            "mode": "managed",
            "type": "aws_iam_role_policy_attachment",
            "name": "eks_worker_node",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
                "actions": [
                    "create"
                ],
                "before": null,
                "after": {
                    "policy_arn": "arn:aws:iam::aws:policy/AmazonEKSWorkerNodePolicy",
                    "role": "cis-eks-compliant-node-group-role"
                },
                "after_unknown": {
                    "id": true
                },
                "before_sensitive": false,
                "after_sensitive": {}
            }
        },
        {
            "address": "aws_kms_key.eks",
            "mode": "managed",
            "type": "aws_kms_key",
            "name": "eks",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
                "actions": [
                    "create"
                ],
                "before": null,
                "after": {
                    "bypass_policy_lockout_safety_check": false,
                    "custom_key_store_id": null,
                    "customer_master_key_spec": "SYMMETRIC_DEFAULT",
                    "deletion_window_in_days": 7,
                    "description": "EKS Secret Encryption Key",
                    "enable_key_rotation": true,
                    "is_enabled": true,
                    "key_usage": "ENCRYPT_DECRYPT",
                    "tags": null,
                    "timeouts": null,
                    "xks_key_id": null
                },
                "after_unknown": {
                    "arn": true,
                    "id": true,
                    "key_id": true,
                    "multi_region": true,
                    "policy": true,
                    "rotation_period_in_days": true,
                    "tags_all": true
                },
                "before_sensitive": false,
                "after_sensitive": {
                    "tags_all": {}
                }
            }
        },
        {
            "address": "aws_s3_bucket.automation",
            "mode": "managed",
            "type": "aws_s3_bucket",
            "name": "automation",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
                "actions": [
                    "delete"
                ],
                "before": {
                    "acceleration_status": "",
                    "acl": null,
                    "arn": "arn:aws:s3:::eks-kyverno-automation-b8fe30df",
                    "bucket": "eks-kyverno-automation-b8fe30df",
                    "bucket_domain_name": "eks-kyverno-automation-b8fe30df.s3.amazonaws.com",
                    "bucket_prefix": "",
                    "bucket_regional_domain_name": "eks-kyverno-automation-b8fe30df.s3.us-west-2.amazonaws.com",
                    "cors_rule": [],
                    "force_destroy": false,
                    "grant": [
                        {
                            "id": "f82eea0c4cb951fc6f9b075f4c61e9a0a175028ba7a7037c6f3c9cd822b89c07",
                            "permissions": [
                                "FULL_CONTROL"
                            ],
                            "type": "CanonicalUser",
                            "uri": ""
                        }
                    ],
                    "hosted_zone_id": "Z3BJ6K6RIION7M",
                    "id": "eks-kyverno-automation-b8fe30df",
                    "lifecycle_rule": [],
                    "logging": [],
                    "object_lock_configuration": [],
                    "object_lock_enabled": false,
                    "policy": "",
                    "region": "us-west-2",
                    "replication_configuration": [],
                    "request_payer": "BucketOwner",
                    "server_side_encryption_configuration": [
                        {
                            "rule": [
                                {
                                    "apply_server_side_encryption_by_default": [
                                        {
                                            "kms_master_key_id": "",
                                            "sse_algorithm": "AES256"
                                        }
                                    ],
                                    "bucket_key_enabled": false
                                }
                            ]
                        }
                    ],
                    "tags": {
                        "Name": "eks-kyverno-automation"
                    },
                    "tags_all": {
                        "Name": "eks-kyverno-automation"
                    },
                    "timeouts": null,
                    "versioning": [
                        {
                            "enabled": false,
                            "mfa_delete": false
                        }
                    ],
                    "website": [],
                    "website_domain": null,
                    "website_endpoint": null
                },
                "after": null,
                "after_unknown": {},
                "before_sensitive": {
                    "cors_rule": [],
                    "grant": [
                        {
                            "permissions": [
                                false
                            ]
                        }
                    ],
                    "lifecycle_rule": [],
                    "logging": [],
                    "object_lock_configuration": [],
                    "replication_configuration": [],
                    "server_side_encryption_configuration": [
                        {
                            "rule": [
                                {
                                    "apply_server_side_encryption_by_default": [
                                        {}
                                    ]
                                }
                            ]
                        }
                    ],
                    "tags": {},
                    "tags_all": {},
                    "versioning": [
                        {}
                    ],
                    "website": []
                },
                "after_sensitive": false
            },
            "action_reason": "delete_because_no_resource_config"
        },
        {
            "address": "aws_security_group.nodes",
            "mode": "managed",
            "type": "aws_security_group",
            "name": "nodes",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
                "actions": [
                    "create"
                ],
                "before": null,
                "after": {
                    "description": "Node group security group",
                    "egress": [
                        {
                            "cidr_blocks": [
                                "0.0.0.0/0"
                            ],
                            "description": "",
                            "from_port": 0,
                            "ipv6_cidr_blocks": [],
                            "prefix_list_ids": [],
                            "protocol": "-1",
                            "security_groups": [],
                            "self": false,
                            "to_port": 0
                        }
                    ],
                    "ingress": [
                        {
                            "cidr_blocks": [],
                            "description": "",
                            "from_port": 0,
                            "ipv6_cidr_blocks": [],
                            "prefix_list_ids": [],
                            "protocol": "-1",
                            "security_groups": [],
                            "self": true,
                            "to_port": 0
                        }
                    ],
                    "name": "cis-eks-compliant-nodes",
                    "revoke_rules_on_delete": false,
                    "tags": null,
                    "timeouts": null
                },
                "after_unknown": {
                    "arn": true,
                    "egress": [
                        {
                            "cidr_blocks": [
                                false
                            ],
                            "ipv6_cidr_blocks": [],
                            "prefix_list_ids": [],
                            "security_groups": []
                        }
                    ],
                    "id": true,
                    "ingress": [
                        {
                            "cidr_blocks": [],
                            "ipv6_cidr_blocks": [],
                            "prefix_list_ids": [],
                            "security_groups": []
                        }
                    ],
                    "name_prefix": true,
                    "owner_id": true,
                    "tags_all": true,
                    "vpc_id": true
                },
                "before_sensitive": false,
                "after_sensitive": {
                    "egress": [
                        {
                            "cidr_blocks": [
                                false
                            ],
                            "ipv6_cidr_blocks": [],
                            "prefix_list_ids": [],
                            "security_groups": []
                        }
                    ],
                    "ingress": [
                        {
                            "cidr_blocks": [],
                            "ipv6_cidr_blocks": [],
                            "prefix_list_ids": [],
                            "security_groups": []
                        }
                    ],
                    "tags_all": {}
                }
            }
        },
        {
            "address": "aws_subnet.private[0]",
            "mode": "managed",
            "type": "aws_subnet",
            "name": "private",
            "index": 0,
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
                "actions": [
                    "create"
                ],
                "before": null,
                "after": {
                    "assign_ipv6_address_on_creation": false,
                    "availability_zone": "us-west-2a",
                    "cidr_block": "10.0.1.0/24",
                    "customer_owned_ipv4_pool": null,
                    "enable_dns64": false,
                    "enable_lni_at_device_index": null,
                    "enable_resource_name_dns_a_record_on_launch": false,
                    "enable_resource_name_dns_aaaa_record_on_launch": false,
                    "ipv6_cidr_block": null,
                    "ipv6_native": false,
                    "map_customer_owned_ip_on_launch": null,
                    "map_public_ip_on_launch": false,
                    "outpost_arn": null,
                    "tags": {
                        "kubernetes.io/cluster/cis-eks-compliant": "owned",
                        "kubernetes.io/role/internal-elb": "1"
                    },
                    "tags_all": {
                        "kubernetes.io/cluster/cis-eks-compliant": "owned",
                        "kubernetes.io/role/internal-elb": "1"
                    },
                    "timeouts": null
                },
                "after_unknown": {
                    "arn": true,
                    "availability_zone_id": true,
                    "id": true,
                    "ipv6_cidr_block_association_id": true,
                    "owner_id": true,
                    "private_dns_hostname_type_on_launch": true,
                    "tags": {},
                    "tags_all": {},
                    "vpc_id": true
                },
                "before_sensitive": false,
                "after_sensitive": {
                    "tags": {},
                    "tags_all": {}
                }
            }
        },
        {
            "address": "aws_subnet.private[1]",
            "mode": "managed",
            "type": "aws_subnet",
            "name": "private",
            "index": 1,
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
                "actions": [
                    "create"
                ],
                "before": null,
                "after": {
                    "assign_ipv6_address_on_creation": false,
                    "availability_zone": "us-west-2b",
                    "cidr_block": "10.0.2.0/24",
                    "customer_owned_ipv4_pool": null,
                    "enable_dns64": false,
                    "enable_lni_at_device_index": null,
                    "enable_resource_name_dns_a_record_on_launch": false,
                    "enable_resource_name_dns_aaaa_record_on_launch": false,
                    "ipv6_cidr_block": null,
                    "ipv6_native": false,
                    "map_customer_owned_ip_on_launch": null,
                    "map_public_ip_on_launch": false,
                    "outpost_arn": null,
                    "tags": {
                        "kubernetes.io/cluster/cis-eks-compliant": "owned",
                        "kubernetes.io/role/internal-elb": "1"
                    },
                    "tags_all": {
                        "kubernetes.io/cluster/cis-eks-compliant": "owned",
                        "kubernetes.io/role/internal-elb": "1"
                    },
                    "timeouts": null
                },
                "after_unknown": {
                    "arn": true,
                    "availability_zone_id": true,
                    "id": true,
                    "ipv6_cidr_block_association_id": true,
                    "owner_id": true,
                    "private_dns_hostname_type_on_launch": true,
                    "tags": {},
                    "tags_all": {},
                    "vpc_id": true
                },
                "before_sensitive": false,
                "after_sensitive": {
                    "tags": {},
                    "tags_all": {}
                }
            }
        },
        {
            "address": "aws_subnet.private[2]",
            "mode": "managed",
            "type": "aws_subnet",
            "name": "private",
            "index": 2,
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
                "actions": [
                    "create"
                ],
                "before": null,
                "after": {
                    "assign_ipv6_address_on_creation": false,
                    "availability_zone": "us-west-2c",
                    "cidr_block": "10.0.3.0/24",
                    "customer_owned_ipv4_pool": null,
                    "enable_dns64": false,
                    "enable_lni_at_device_index": null,
                    "enable_resource_name_dns_a_record_on_launch": false,
                    "enable_resource_name_dns_aaaa_record_on_launch": false,
                    "ipv6_cidr_block": null,
                    "ipv6_native": false,
                    "map_customer_owned_ip_on_launch": null,
                    "map_public_ip_on_launch": false,
                    "outpost_arn": null,
                    "tags": {
                        "kubernetes.io/cluster/cis-eks-compliant": "owned",
                        "kubernetes.io/role/internal-elb": "1"
                    },
                    "tags_all": {
                        "kubernetes.io/cluster/cis-eks-compliant": "owned",
                        "kubernetes.io/role/internal-elb": "1"
                    },
                    "timeouts": null
                },
                "after_unknown": {
                    "arn": true,
                    "availability_zone_id": true,
                    "id": true,
                    "ipv6_cidr_block_association_id": true,
                    "owner_id": true,
                    "private_dns_hostname_type_on_launch": true,
                    "tags": {},
                    "tags_all": {},
                    "vpc_id": true
                },
                "before_sensitive": false,
                "after_sensitive": {
                    "tags": {},
                    "tags_all": {}
                }
            }
        },
        {
            "address": "aws_vpc.main",
            "mode": "managed",
            "type": "aws_vpc",
            "name": "main",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
                "actions": [
                    "create"
                ],
                "before": null,
                "after": {
                    "assign_generated_ipv6_cidr_block": null,
                    "cidr_block": "10.0.0.0/16",
                    "enable_dns_hostnames": true,
                    "enable_dns_support": true,
                    "instance_tenancy": "default",
                    "ipv4_ipam_pool_id": null,
                    "ipv4_netmask_length": null,
                    "ipv6_ipam_pool_id": null,
                    "ipv6_netmask_length": null,
                    "tags": null
                },
                "after_unknown": {
                    "arn": true,
                    "default_network_acl_id": true,
                    "default_route_table_id": true,
                    "default_security_group_id": true,
                    "dhcp_options_id": true,
                    "enable_network_address_usage_metrics": true,
                    "id": true,
                    "ipv6_association_id": true,
                    "ipv6_cidr_block": true,
                    "ipv6_cidr_block_network_border_group": true,
                    "main_route_table_id": true,
                    "owner_id": true,
                    "tags_all": true
                },
                "before_sensitive": false,
                "after_sensitive": {
                    "tags_all": {}
                }
            }
        },
        {
            "address": "kubernetes_network_policy.default_deny_all",
            "mode": "managed",
            "type": "kubernetes_network_policy",
            "name": "default_deny_all",
            "provider_name": "registry.terraform.io/hashicorp/kubernetes",
            "change": {
                "actions": [
                    "create"
                ],
                "before": null,
                "after": {
                    "metadata": [
                        {
                            "annotations": null,
                            "generate_name": null,
                            "labels": null,
                            "name": "default-deny-all",
                            "namespace": "default"
                        }
                    ],
                    "spec": [
                        {
                            "egress": [],
                            "ingress": [],
                            "pod_selector": [
                                {
                                    "match_expressions": [],
                                    "match_labels": null
                                }
                            ],
                            "policy_types": [
                                "Ingress",
                                "Egress"
                            ]
                        }
                    ]
                },
                "after_unknown": {
                    "id": true,
                    "metadata": [
                        {
                            "generation": true,
                            "resource_version": true,
                            "uid": true
                        }
                    ],
                    "spec": [
                        {
                            "egress": [],
                            "ingress": [],
                            "pod_selector": [
                                {
                                    "match_expressions": []
                                }
                            ],
                            "policy_types": [
                                false,
                                false
                            ]
                        }
                    ]
                },
                "before_sensitive": false,
                "after_sensitive": {
                    "metadata": [
                        {}
                    ],
                    "spec": [
                        {
                            "egress": [],
                            "ingress": [],
                            "pod_selector": [
                                {
                                    "match_expressions": []
                                }
                            ],
                            "policy_types": [
                                false,
                                false
                            ]
                        }
                    ]
                }
            }
        },
        {
            "address": "random_id.s3_suffix",
            "mode": "managed",
            "type": "random_id",
            "name": "s3_suffix",
            "provider_name": "registry.terraform.io/hashicorp/random",
            "change": {
                "actions": [
                    "delete"
                ],
                "before": {
                    "b64_std": "uP4w3w==",
                    "b64_url": "uP4w3w",
                    "byte_length": 4,
                    "dec": "3103666399",
                    "hex": "b8fe30df",
                    "id": "uP4w3w",
                    "keepers": null,
                    "prefix": null
                },
                "after": null,
                "after_unknown": {},
                "before_sensitive": {},
                "after_sensitive": false
            },
            "action_reason": "delete_because_no_resource_config"
        }
    ],
    "output_changes": {
        "cluster_name": {
            "actions": [
                "create"
            ],
            "before": null,
            "after": "cis-eks-compliant",
            "after_unknown": false,
            "before_sensitive": false,
            "after_sensitive": false
        },
        "region": {
            "actions": [
                "create"
            ],
            "before": null,
            "after": "us-west-2",
            "after_unknown": false,
            "before_sensitive": false,
            "after_sensitive": false
        }
    },
    "prior_state": {
        "format_version": "1.0",
        "terraform_version": "1.5.7",
        "values": {
            "outputs": {
                "cluster_name": {
                    "sensitive": false,
                    "value": "cis-eks-compliant",
                    "type": "string"
                },
                "region": {
                    "sensitive": false,
                    "value": "us-west-2",
                    "type": "string"
                }
            },
            "root_module": {
                "resources": [
                    {
                        "address": "aws_s3_bucket.automation",
                        "mode": "managed",
                        "type": "aws_s3_bucket",
                        "name": "automation",
                        "provider_name": "registry.terraform.io/hashicorp/aws",
                        "schema_version": 0,
                        "values": {
                            "acceleration_status": "",
                            "acl": null,
                            "arn": "arn:aws:s3:::eks-kyverno-automation-b8fe30df",
                            "bucket": "eks-kyverno-automation-b8fe30df",
                            "bucket_domain_name": "eks-kyverno-automation-b8fe30df.s3.amazonaws.com",
                            "bucket_prefix": "",
                            "bucket_regional_domain_name": "eks-kyverno-automation-b8fe30df.s3.us-west-2.amazonaws.com",
                            "cors_rule": [],
                            "force_destroy": false,
                            "grant": [
                                {
                                    "id": "f82eea0c4cb951fc6f9b075f4c61e9a0a175028ba7a7037c6f3c9cd822b89c07",
                                    "permissions": [
                                        "FULL_CONTROL"
                                    ],
                                    "type": "CanonicalUser",
                                    "uri": ""
                                }
                            ],
                            "hosted_zone_id": "Z3BJ6K6RIION7M",
                            "id": "eks-kyverno-automation-b8fe30df",
                            "lifecycle_rule": [],
                            "logging": [],
                            "object_lock_configuration": [],
                            "object_lock_enabled": false,
                            "policy": "",
                            "region": "us-west-2",
                            "replication_configuration": [],
                            "request_payer": "BucketOwner",
                            "server_side_encryption_configuration": [
                                {
                                    "rule": [
                                        {
                                            "apply_server_side_encryption_by_default": [
                                                {
                                                    "kms_master_key_id": "",
                                                    "sse_algorithm": "AES256"
                                                }
                                            ],
                                            "bucket_key_enabled": false
                                        }
                                    ]
                                }
                            ],
                            "tags": {
                                "Name": "eks-kyverno-automation"
                            },
                            "tags_all": {
                                "Name": "eks-kyverno-automation"
                            },
                            "timeouts": null,
                            "versioning": [
                                {
                                    "enabled": false,
                                    "mfa_delete": false
                                }
                            ],
                            "website": [],
                            "website_domain": null,
                            "website_endpoint": null
                        },
                        "sensitive_values": {
                            "cors_rule": [],
                            "grant": [
                                {
                                    "permissions": [
                                        false
                                    ]
                                }
                            ],
                            "lifecycle_rule": [],
                            "logging": [],
                            "object_lock_configuration": [],
                            "replication_configuration": [],
                            "server_side_encryption_configuration": [
                                {
                                    "rule": [
                                        {
                                            "apply_server_side_encryption_by_default": [
                                                {}
                                            ]
                                        }
                                    ]
                                }
                            ],
                            "tags": {},
                            "tags_all": {},
                            "versioning": [
                                {}
                            ],
                            "website": []
                        },
                        "depends_on": [
                            "random_id.s3_suffix"
                        ]
                    },
                    {
                        "address": "random_id.s3_suffix",
                        "mode": "managed",
                        "type": "random_id",
                        "name": "s3_suffix",
                        "provider_name": "registry.terraform.io/hashicorp/random",
                        "schema_version": 0,
                        "values": {
                            "b64_std": "uP4w3w==",
                            "b64_url": "uP4w3w",
                            "byte_length": 4,
                            "dec": "3103666399",
                            "hex": "b8fe30df",
                            "id": "uP4w3w",
                            "keepers": null,
                            "prefix": null
                        },
                        "sensitive_values": {}
                    }
                ]
            }
        }
    },
    "configuration": {
        "provider_config": {
            "aws": {
                "name": "aws",
                "full_name": "registry.terraform.io/hashicorp/aws",
                "expressions": {
                    "region": {
                        "references": [
                            "var.region"
                        ]
                    }
                }
            },
            "kubernetes": {
                "name": "kubernetes",
                "full_name": "registry.terraform.io/hashicorp/kubernetes"
            }
        },
        "root_module": {
            "outputs": {
                "cluster_name": {
                    "expression": {
                        "references": [
                            "var.cluster_name"
                        ]
                    },
                    "description": "Name of the EKS cluster"
                },
                "region": {
                    "expression": {
                        "references": [
                            "var.region"
                        ]
                    },
                    "description": "AWS region to deploy resources in"
                }
            },
            "resources": [
                {
                    "address": "aws_eks_cluster.main",
                    "mode": "managed",
                    "type": "aws_eks_cluster",
                    "name": "main",
                    "provider_config_key": "aws",
                    "expressions": {
                        "enabled_cluster_log_types": {
                            "constant_value": [
                                "api",
                                "audit",
                                "authenticator",
                                "controllerManager",
                                "scheduler"
                            ]
                        },
                        "encryption_config": [
                            {
                                "provider": [
                                    {
                                        "key_arn": {
                                            "references": [
                                                "aws_kms_key.eks.arn",
                                                "aws_kms_key.eks"
                                            ]
                                        }
                                    }
                                ],
                                "resources": {
                                    "constant_value": [
                                        "secrets"
                                    ]
                                }
                            }
                        ],
                        "kubernetes_network_config": [
                            {
                                "service_ipv4_cidr": {
                                    "constant_value": "10.100.0.0/16"
                                }
                            }
                        ],
                        "name": {
                            "references": [
                                "var.cluster_name"
                            ]
                        },
                        "role_arn": {
                            "references": [
                                "aws_iam_role.eks.arn",
                                "aws_iam_role.eks"
                            ]
                        },
                        "version": {
                            "references": [
                                "var.cluster_version"
                            ]
                        },
                        "vpc_config": [
                            {
                                "endpoint_private_access": {
                                    "constant_value": true
                                },
                                "endpoint_public_access": {
                                    "constant_value": false
                                },
                                "subnet_ids": {
                                    "references": [
                                        "aws_subnet.private"
                                    ]
                                }
                            }
                        ]
                    },
                    "schema_version": 1
                },
                {
                    "address": "aws_eks_node_group.main",
                    "mode": "managed",
                    "type": "aws_eks_node_group",
                    "name": "main",
                    "provider_config_key": "aws",
                    "expressions": {
                        "capacity_type": {
                            "constant_value": "ON_DEMAND"
                        },
                        "cluster_name": {
                            "references": [
                                "aws_eks_cluster.main.name",
                                "aws_eks_cluster.main"
                            ]
                        },
                        "instance_types": {
                            "references": [
                                "var.node_instance_type"
                            ]
                        },
                        "node_group_name": {
                            "constant_value": "compliant-ng"
                        },
                        "node_role_arn": {
                            "references": [
                                "aws_iam_role.eks_node_group.arn",
                                "aws_iam_role.eks_node_group"
                            ]
                        },
                        "scaling_config": [
                            {
                                "desired_size": {
                                    "constant_value": 1
                                },
                                "max_size": {
                                    "constant_value": 1
                                },
                                "min_size": {
                                    "constant_value": 1
                                }
                            }
                        ],
                        "subnet_ids": {
                            "references": [
                                "aws_subnet.private"
                            ]
                        }
                    },
                    "schema_version": 0,
                    "depends_on": [
                        "aws_security_group.nodes"
                    ]
                },
                {
                    "address": "aws_iam_role.eks",
                    "mode": "managed",
                    "type": "aws_iam_role",
                    "name": "eks",
                    "provider_config_key": "aws",
                    "expressions": {
                        "assume_role_policy": {},
                        "name": {
                            "constant_value": "cis-eks-compliant-eks-role"
                        }
                    },
                    "schema_version": 0
                },
                {
                    "address": "aws_iam_role.eks_node_group",
                    "mode": "managed",
                    "type": "aws_iam_role",
                    "name": "eks_node_group",
                    "provider_config_key": "aws",
                    "expressions": {
                        "assume_role_policy": {},
                        "name": {
                            "references": [
                                "var.cluster_name"
                            ]
                        }
                    },
                    "schema_version": 0
                },
                {
                    "address": "aws_iam_role_policy_attachment.ec2_container_registry",
                    "mode": "managed",
                    "type": "aws_iam_role_policy_attachment",
                    "name": "ec2_container_registry",
                    "provider_config_key": "aws",
                    "expressions": {
                        "policy_arn": {
                            "constant_value": "arn:aws:iam::aws:policy/AmazonEC2ContainerRegistryReadOnly"
                        },
                        "role": {
                            "references": [
                                "aws_iam_role.eks_node_group.name",
                                "aws_iam_role.eks_node_group"
                            ]
                        }
                    },
                    "schema_version": 0
                },
                {
                    "address": "aws_iam_role_policy_attachment.eks_cluster_policy",
                    "mode": "managed",
                    "type": "aws_iam_role_policy_attachment",
                    "name": "eks_cluster_policy",
                    "provider_config_key": "aws",
                    "expressions": {
                        "policy_arn": {
                            "constant_value": "arn:aws:iam::aws:policy/AmazonEKSClusterPolicy"
                        },
                        "role": {
                            "references": [
                                "aws_iam_role.eks.name",
                                "aws_iam_role.eks"
                            ]
                        }
                    },
                    "schema_version": 0
                },
                {
                    "address": "aws_iam_role_policy_attachment.eks_cni",
                    "mode": "managed",
                    "type": "aws_iam_role_policy_attachment",
                    "name": "eks_cni",
                    "provider_config_key": "aws",
                    "expressions": {
                        "policy_arn": {
                            "constant_value": "arn:aws:iam::aws:policy/AmazonEKS_CNI_Policy"
                        },
                        "role": {
                            "references": [
                                "aws_iam_role.eks_node_group.name",
                                "aws_iam_role.eks_node_group"
                            ]
                        }
                    },
                    "schema_version": 0
                },
                {
                    "address": "aws_iam_role_policy_attachment.eks_worker_node",
                    "mode": "managed",
                    "type": "aws_iam_role_policy_attachment",
                    "name": "eks_worker_node",
                    "provider_config_key": "aws",
                    "expressions": {
                        "policy_arn": {
                            "constant_value": "arn:aws:iam::aws:policy/AmazonEKSWorkerNodePolicy"
                        },
                        "role": {
                            "references": [
                                "aws_iam_role.eks_node_group.name",
                                "aws_iam_role.eks_node_group"
                            ]
                        }
                    },
                    "schema_version": 0
                },
                {
                    "address": "aws_kms_key.eks",
                    "mode": "managed",
                    "type": "aws_kms_key",
                    "name": "eks",
                    "provider_config_key": "aws",
                    "expressions": {
                        "deletion_window_in_days": {
                            "constant_value": 7
                        },
                        "description": {
                            "constant_value": "EKS Secret Encryption Key"
                        },
                        "enable_key_rotation": {
                            "constant_value": true
                        }
                    },
                    "schema_version": 0
                },
                {
                    "address": "aws_security_group.nodes",
                    "mode": "managed",
                    "type": "aws_security_group",
                    "name": "nodes",
                    "provider_config_key": "aws",
                    "expressions": {
                        "description": {
                            "constant_value": "Node group security group"
                        },
                        "egress": {
                            "constant_value": [
                                {
                                    "cidr_blocks": [
                                        "0.0.0.0/0"
                                    ],
                                    "description": null,
                                    "from_port": 0,
                                    "ipv6_cidr_blocks": null,
                                    "prefix_list_ids": null,
                                    "protocol": "-1",
                                    "security_groups": null,
                                    "self": null,
                                    "to_port": 0
                                }
                            ]
                        },
                        "ingress": {
                            "constant_value": [
                                {
                                    "cidr_blocks": null,
                                    "description": null,
                                    "from_port": 0,
                                    "ipv6_cidr_blocks": null,
                                    "prefix_list_ids": null,
                                    "protocol": "-1",
                                    "security_groups": null,
                                    "self": true,
                                    "to_port": 0
                                }
                            ]
                        },
                        "name": {
                            "references": [
                                "var.cluster_name"
                            ]
                        },
                        "vpc_id": {
                            "references": [
                                "aws_vpc.main.id",
                                "aws_vpc.main"
                            ]
                        }
                    },
                    "schema_version": 1
                },
                {
                    "address": "aws_subnet.private",
                    "mode": "managed",
                    "type": "aws_subnet",
                    "name": "private",
                    "provider_config_key": "aws",
                    "expressions": {
                        "availability_zone": {
                            "references": [
                                "var.region",
                                "var.region",
                                "var.region",
                                "count.index"
                            ]
                        },
                        "cidr_block": {
                            "references": [
                                "var.private_subnets",
                                "count.index"
                            ]
                        },
                        "tags": {
                            "references": [
                                "var.cluster_name"
                            ]
                        },
                        "vpc_id": {
                            "references": [
                                "aws_vpc.main.id",
                                "aws_vpc.main"
                            ]
                        }
                    },
                    "schema_version": 1,
                    "count_expression": {
                        "references": [
                            "var.private_subnets"
                        ]
                    }
                },
                {
                    "address": "aws_vpc.main",
                    "mode": "managed",
                    "type": "aws_vpc",
                    "name": "main",
                    "provider_config_key": "aws",
                    "expressions": {
                        "cidr_block": {
                            "references": [
                                "var.vpc_cidr"
                            ]
                        },
                        "enable_dns_hostnames": {
                            "constant_value": true
                        },
                        "enable_dns_support": {
                            "constant_value": true
                        }
                    },
                    "schema_version": 1
                },
                {
                    "address": "kubernetes_network_policy.default_deny_all",
                    "mode": "managed",
                    "type": "kubernetes_network_policy",
                    "name": "default_deny_all",
                    "provider_config_key": "kubernetes",
                    "expressions": {
                        "metadata": [
                            {
                                "name": {
                                    "constant_value": "default-deny-all"
                                },
                                "namespace": {
                                    "constant_value": "default"
                                }
                            }
                        ],
                        "spec": [
                            {
                                "pod_selector": [
                                    {}
                                ],
                                "policy_types": {
                                    "constant_value": [
                                        "Ingress",
                                        "Egress"
                                    ]
                                }
                            }
                        ]
                    },
                    "schema_version": 0
                },
                {
                    "address": "data.aws_eks_cluster.main",
                    "mode": "data",
                    "type": "aws_eks_cluster",
                    "name": "main",
                    "provider_config_key": "aws",
                    "expressions": {
                        "name": {
                            "references": [
                                "aws_eks_cluster.main.name",
                                "aws_eks_cluster.main"
                            ]
                        }
                    },
                    "schema_version": 0
                },
                {
                    "address": "data.aws_eks_cluster_auth.main",
                    "mode": "data",
                    "type": "aws_eks_cluster_auth",
                    "name": "main",
                    "provider_config_key": "aws",
                    "expressions": {
                        "name": {
                            "references": [
                                "aws_eks_cluster.main.name",
                                "aws_eks_cluster.main"
                            ]
                        }
                    },
                    "schema_version": 0
                }
            ],
            "variables": {
                "cluster_name": {
                    "default": "cis-eks-compliant",
                    "description": "Name of the EKS cluster"
                },
                "cluster_version": {
                    "default": "1.28",
                    "description": "Kubernetes version for the EKS cluster"
                },
                "desired_capacity": {
                    "default": 2,
                    "description": "Desired node group size"
                },
                "max_size": {
                    "default": 3,
                    "description": "Maximum node group size"
                },
                "min_size": {
                    "default": 1,
                    "description": "Minimum node group size"
                },
                "node_instance_type": {
                    "default": "t3.small",
                    "description": "Instance type for EKS node group"
                },
                "private_subnets": {
                    "default": [
                        "10.0.1.0/24",
                        "10.0.2.0/24",
                        "10.0.3.0/24"
                    ],
                    "description": "List of private subnet CIDR blocks"
                },
                "public_subnets": {
                    "default": [
                        "10.0.4.0/24",
                        "10.0.5.0/24",
                        "10.0.6.0/24"
                    ],
                    "description": "List of public subnet CIDR blocks"
                },
                "region": {
                    "default": "us-west-2",
                    "description": "AWS region to deploy resources in"
                },
                "vpc_cidr": {
                    "default": "10.0.0.0/16",
                    "description": "CIDR block for the VPC"
                }
            }
        }
    },
    "relevant_attributes": [
        {
            "resource": "aws_subnet.private",
            "attribute": []
        },
        {
            "resource": "aws_kms_key.eks",
            "attribute": [
                "arn"
            ]
        },
        {
            "resource": "aws_eks_cluster.main",
            "attribute": [
                "name"
            ]
        },
        {
            "resource": "aws_iam_role.eks_node_group",
            "attribute": [
                "arn"
            ]
        },
        {
            "resource": "aws_iam_role.eks_node_group",
            "attribute": [
                "name"
            ]
        },
        {
            "resource": "aws_iam_role.eks",
            "attribute": [
                "name"
            ]
        },
        {
            "resource": "aws_vpc.main",
            "attribute": [
                "id"
            ]
        },
        {
            "resource": "aws_iam_role.eks",
            "attribute": [
                "arn"
            ]
        }
    ],
    "timestamp": "2025-05-24T08:07:59Z"
}
